{
  "hash": "d0fbef0c2323a2ff72ef54f0f44012b2",
  "result": {
    "markdown": "---\ntitle: \"Challenge 8: Joining Data\"\nauthor: \"Surya Praneeth Reddy Chirasani\"\ndescription: \"\"\ndate: \"01/28/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - challenge_8\n  - snl\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readr)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## Data Description\n\nFor this challenge I am using SNL dataset for my analysis. There are three data files: actors.csv, casts.csv and season.csv. actors file contains gender information regarding different types(\"cast\", \"guest\", \"crew\", \"unknown\") of actors, casts file contains information regarding which seasons the actor appeared in and how many episodes, and finally the seasons file has information about, what year the season of SNL happened and total number of episodes that season has.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactors <- read_csv(\"_data/snl_actors.csv\", show_col_types = FALSE)\ncasts <- read_csv(\"_data/snl_casts.csv\", show_col_types = FALSE)\nseasons <- read_csv(\"_data/snl_seasons.csv\", show_col_types = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nactors\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2,306 × 4\n   aid            url           type  gender \n   <chr>          <chr>         <chr> <chr>  \n 1 Kate McKinnon  /Cast/?KaMc   cast  female \n 2 Alex Moffat    /Cast/?AlMo   cast  male   \n 3 Ego Nwodim     /Cast/?EgNw   cast  unknown\n 4 Chris Redd     /Cast/?ChRe   cast  male   \n 5 Kenan Thompson /Cast/?KeTh   cast  male   \n 6 Carey Mulligan /Guests/?3677 guest andy   \n 7 Marcus Mumford /Guests/?3679 guest male   \n 8 Aidy Bryant    /Cast/?AiBr   cast  female \n 9 Steve Higgins  /Crew/?StHi   crew  male   \n10 Mikey Day      /Cast/?MiDa   cast  male   \n# … with 2,296 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncasts\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 614 × 8\n   aid                sid featured first_epid last_epid update…¹ n_epi…² seaso…³\n   <chr>            <dbl> <lgl>         <dbl>     <dbl> <lgl>      <dbl>   <dbl>\n 1 A. Whitney Brown    11 TRUE       19860222        NA FALSE          8   0.444\n 2 A. Whitney Brown    12 TRUE             NA        NA FALSE         20   1    \n 3 A. Whitney Brown    13 TRUE             NA        NA FALSE         13   1    \n 4 A. Whitney Brown    14 TRUE             NA        NA FALSE         20   1    \n 5 A. Whitney Brown    15 TRUE             NA        NA FALSE         20   1    \n 6 A. Whitney Brown    16 TRUE             NA        NA FALSE         20   1    \n 7 Alan Zweibel         5 TRUE       19800409        NA FALSE          5   0.25 \n 8 Sasheer Zamata      39 TRUE       20140118        NA FALSE         11   0.524\n 9 Sasheer Zamata      40 TRUE             NA        NA FALSE         21   1    \n10 Sasheer Zamata      41 FALSE            NA        NA FALSE         21   1    \n# … with 604 more rows, and abbreviated variable names ¹​update_anchor,\n#   ²​n_episodes, ³​season_fraction\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nseasons\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 46 × 5\n     sid  year first_epid last_epid n_episodes\n   <dbl> <dbl>      <dbl>     <dbl>      <dbl>\n 1     1  1975   19751011  19760731         24\n 2     2  1976   19760918  19770521         22\n 3     3  1977   19770924  19780520         20\n 4     4  1978   19781007  19790526         20\n 5     5  1979   19791013  19800524         20\n 6     6  1980   19801115  19810411         13\n 7     7  1981   19811003  19820522         20\n 8     8  1982   19820925  19830514         20\n 9     9  1983   19831008  19840512         19\n10    10  1984   19841006  19850413         17\n# … with 36 more rows\n```\n:::\n:::\n\n\n## Gender Analysis\n\nLooking at the data, gender is one aspect we can see how the casts makeup changed with time. Since this is a known disparity in most of the industries including entertainment industry, this would be a good question to answer. For the analysis, instead of just comparing number of cast for each gender type in each season, to keep it fair I calculated the total number of episodes each gender appeared in each season. This metric seems better representation of how much each gender appeared on SNL\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncasts_gender_episodes_count <- casts  %>%\n  left_join(filter(actors,type==\"cast\"),\n            by=\"aid\") %>%\n  count(sid,gender, n_episodes) %>%\n  mutate(total_episodes = n_episodes*n) %>%\n  select(sid, gender, total_episodes) %>%\n  group_by(sid, gender) %>%\n  summarise(total = sum(total_episodes))%>%\n  ungroup() %>%\n  left_join(seasons)%>%\n  filter(!is.na(gender))%>%\n  select(sid, gender, year, total)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'sid'. You can override using the `.groups`\nargument.\nJoining, by = \"sid\"\n```\n:::\n\n```{.r .cell-code}\ncasts_gender_episodes_count\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 95 × 4\n     sid gender  year total\n   <dbl> <chr>  <dbl> <dbl>\n 1     1 female  1975    72\n 2     1 male    1975   101\n 3     2 female  1976    66\n 4     2 male    1976    84\n 5     3 female  1977    60\n 6     3 male    1977   120\n 7     4 female  1978    60\n 8     4 male    1978   120\n 9     5 female  1979    60\n10     5 male    1979   172\n# … with 85 more rows\n```\n:::\n:::\n\n\nI have used \"left_join\" to join the casts and actors data since we are focusing our analysis on gender makeup of \"casts\". After that, I counted the number of episodes each gender appeared in, using count function. I used \"group_by\" to sum over all the episodes all the actors of each gender appeared in. Finally, I have used \"left_join\" again to get year information of each season, which will help label the x-axis in visualization.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncasts_gender_prop <- casts_gender_episodes_count %>%\n  group_by(sid) %>%\n  mutate(prop=total/sum(total)) %>%\n  ungroup() %>%\n  select(-total)  %>%\n  pivot_wider(names_from = gender,\n              values_from = prop)%>%\n  mutate_at(-1, ~replace_na(., 0))%>%\n  pivot_longer(c(female,male,unknown),\n               values_to = \"prop\",\n               names_to =  \"gender\")\ncasts_gender_prop\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 138 × 4\n     sid  year gender   prop\n   <dbl> <dbl> <chr>   <dbl>\n 1     1  1975 female  0.416\n 2     1  1975 male    0.584\n 3     1  1975 unknown 0    \n 4     2  1976 female  0.44 \n 5     2  1976 male    0.56 \n 6     2  1976 unknown 0    \n 7     3  1977 female  0.333\n 8     3  1977 male    0.667\n 9     3  1977 unknown 0    \n10     4  1978 female  0.333\n# … with 128 more rows\n```\n:::\n:::\n\n\nIn the next series of operations,I used \"group_by\" and \"mutate\" to compute the proportion of gender per season. Some seasons only have \"male\" and \"female\" as the unique genders, while others have \"male\", \"female\", \"other\", and “NA\". To include all genders for each season, I used \"pivot_wider\", \"mutate_at\" to ensure each level of gender is available for each season. In the last step, I have used pivot_longer() to get the data back in a format that will be helpful for visualization.\n\n## Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(casts_gender_prop,aes(year,prop,col=gender)) + theme(plot.title = element_text(hjust = 0.5)) +\n  geom_line(linewidth=1)+\n  labs(title = \"Saturday Night Live - Gender Progression Analysis\", x = \"Year\", y = \"Proportion\")\n```\n\n::: {.cell-output-display}\n![](SuryaPraneethReddyChirasani_challenge8_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\nThe gender makeup fluctuated a lot over the years slowly moving towards 0.5(equality) but far from it, still in 2020. With just the cast gender makeup and number of episodes they appeared in, the analysis I have presented is a simple one. A complex analysis will take into account how much time each gender spent in each episode doing multiple segments for example. Probably male gender could have done more segments compared to female gender and then the difference between the red and green lines will be even more than in the graph I have plotted above.\n\nIn terms of learning, this challenge helped me lot to learn join functions and what variables to consider in order to answer my research question",
    "supporting": [
      "SuryaPraneethReddyChirasani_challenge8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}